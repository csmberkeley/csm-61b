%\begin{blocksection}
\question This question was adapted from LeetCode: cheapest-flights-within-k-stops

There are $n$ cities connected by $m$ flights. Each flight starts from city $u$ and arrives at $v$ with a price $w$. Thus a city is represented as [u, v, w].

Given all the cities and flights, together with starting city \texttt{src} and the destination \texttt{dst}, your task is to find the cheapest price from \texttt{src} to \texttt{dst} with up to $K$ stops. If there is no such route, output -1.

\begin{solution}
The solution was adapted from: https://leetcode.com/problems/cheapest-flights-within-k-stops/discuss/180314/Dijkstra-with-Modification/187297/.

META: This question is "EXTRA HARD". The complete walkthrough of the codes is not recommended, instead, please let students fully understand the following:

We can modify Dijkstra's to solve this problem! Dijkstra's Algorithm by itself doesn't work because we need to limit our solution to $K$ stops. Instead of adding explored nodes to a closed set, then, we simply check if the current count is over $K$. See code below:
\begin{lstlisting}
    public int findCheapestPrice(int n, int[][] flights, int src, int dst, int K) {
        Map<Integer, Map<Integer, Integer>> map = new HashMap<>();
        for (int[] flight : flights) {
            map.putIfAbsent(flight[0], new HashMap<>());
            map.get(flight[0]).put(flight[1], flight[2]);
        }
        PriorityQueue<int[]> pq = new PriorityQueue<>((a, b) ->  a[1] - b[1] );
        pq.offer(new int[]{ src, 0, 0 });
        while (!pq.isEmpty()) {
            int[] current = pq.poll();
            int city = current[0]; int cost = current[1]; int count = current[2];
            if (count > K + 1) continue;
            if (city == dst) {return cost;}
            if (map.containsKey(city)) {
                Map<Integer, Integer> nexts = map.get(city);
                for (int nextCity : nexts.keySet()) {
                    pq.offer(new int[]{ nextCity, cost + nexts.get(nextCity), count + 1 });
                }
            }
        }
        return -1;     
    }
\end{lstlisting}
\end{solution}

%\end{blocksection}